var acc=document.getElementsByClassName("accordion-heading");for(i=0;i<acc.length;i++)acc[i].addEventListener("click",function(){this.classList.toggle("active"),this.nextElementSibling.classList.toggle("active")});function showAlert(e){document.getElementById("copy_alert");var t=document.createElement("div");t.classList="alert-top-right widget-alert",t.innerHTML=e,t.id="copy_alert",document.body.appendChild(t),setTimeout(function(){document.getElementById("copy_alert").remove()},5e3)}function dataURLtoBlob(e){for(var e=e.split(","),t=e[0].match(/:(.*?);/)[1],a=atob(e[1]),r=a.length,n=new Uint8Array(r);r--;)n[r]=a.charCodeAt(r);return new Blob([n],{type:t})}let copyToClipboard=async()=>{var e=await svg2png(qr.dataUrl).then(e=>dataURLtoBlob(e));try{navigator.clipboard.write([new ClipboardItem({"image/png":e})]),showAlert("Image has been copied to your clipboard.")}catch(e){console.error(e)}},nextActiveTab="",maxStringSize=20,utmParamKeys=["utm_source","utm_medium","utm_campaign"],codeDesignIdsForDashboard=["1ca6b347-2673-4ccb-9517-e75715c27ab3","929bb567-24b0-448c-b8a5-43910941a035","5136f209-66d8-4287-9d94-715ac12adc38","e82593c6-d75d-47d9-b9cc-7d9923f8f4c3","8193729e-0218-4276-94e2-f07346181d72","9abc1761-7746-4524-87a9-a7a4d6184119","436a9c0d-60b9-463e-853b-c5482d51bb47","72628d3d-e941-44d4-af39-857953f3c452","bbe17cb4-6491-4fdf-9e2a-fc7dfc794ae1","b95f4cd1-cee5-461d-bc83-6ea5e49f4bd2","f799c6c1-2eee-4e07-adfc-bc4e0feca8c1","727ecb0e-278f-4e15-959b-7d8527477f8e"];function getTemplateData(e){switch(parseInt(e)){case 1:return{dataPattern:"square",logoBackground:!1,logo:"",backgroundColor:"#ffffff",eyeBallShape:"square",eyeFrameShape:"square",eyeFrameColor:"#000000",eyeBallColor:"#000000",isVcard:!1,gradientType:"none",colorLight:"#ffffff",colorDark:"#000000",margin:50,text:null,template:1};case 9:return{dataPattern:"smooth-round",frame:"none",logoBackground:!1,logo:"",frameText:"",backgroundColor:"#000",eyeBallShape:"circle",eyeFrameShape:"rounded",eyeFrameColor:"#ffcd4e",eyeBallColor:"#ffcd4e",isVcard:!1,gradientType:"none",colorLight:"#ffffff",colorDark:"#ffa200",margin:50,text:null,frameColor:"",template:9};case 10:return{dataPattern:"circle",frame:"none",logoBackground:!1,logo:"",frameText:"",backgroundColor:"#ffffff",eyeBallShape:"rounded",eyeFrameShape:"rounded",eyeFrameColor:"#000",eyeBallColor:"#000",isVcard:!1,gradientType:"none",colorLight:"#ffffff",colorDark:"#000",margin:50,text:null,frameColor:"",template:10};case 11:return{dataPattern:"smooth-round",logoBackground:!1,logo:"",backgroundColor:"#ffffff",eyeBallShape:"rounded",eyeFrameShape:"rounded",eyeFrameColor:"#512da8",eyeBallColor:"#512da8",isVcard:!1,gradientType:"none",colorLight:"#ffffff",colorDark:"#7b1fa2",margin:50,text:null,template:11};case 12:return{dataPattern:"smooth-round",logoBackground:!1,logo:"",backgroundColor:"#ffffff",eyeBallShape:"rounded",eyeFrameShape:"rounded",eyeFrameColor:"#388e3c",eyeBallColor:"#388e3c",isVcard:!1,gradientType:"none",colorLight:"#ffffff",colorDark:"#00796b",margin:50,text:null,template:12}}}let inputTypeRegex={url:{regex:new RegExp("(?:[hH][tT]{2}[pP](?:s)?:\\/\\/)?(?:[wW]{3}\\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\\.[a-zA-Z]{1,63}\\b(?:[-a-zA-Z0-9@:%_+.~#()?&\\/=!,]*)"),helpertext:"For e.g.- https://example.com/",errorMsg:"Please enter a valid URL"},campaign_url:{regex:new RegExp("(?:[hH][tT]{2}[pP](?:s)?:\\/\\/)?(?:[wW]{3}\\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\\.[a-zA-Z]{1,63}\\b(?:[-a-zA-Z0-9@:%_+.~#()?&\\/=!,]*)"),errorMsg:"Must be a valid URL"},email:{regex:/[A-Za-z0-9._%+'-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}/,errorMsg:"Please enter a valid email address"},phone:{regex:/^[+]?[(]?([0-9]{1,4})?[)]?[-\s.0-9]{6,15}$/,errorMsg:"Please enter a valid phone number"},homephone:{regex:/^[+]?[(]?([0-9]{1,4})?[)]?[-\s.0-9]{6,15}$/,errorMsg:"Please enter a valid phone number"},color:{regex:/^#[0-9A-F]{6}$/i,errorMsg:"Enter a valid hex code"},medium:{regex:/^(?!\s*$).+/,errorMsg:"This field is required"},source:{regex:/^(?!\s*$).+/,errorMsg:"This field is required"}};class QRCode{constructor(){this.dataUrl=null,this.logo="",this.dataPattern="square",this.frame="none",this.logoBackground=!1,this.frameText="",this.backgroundColor="#ffffff",this.eyeBallShape="square",this.eyeFrameShape="square",this.eyeFrameColor="#000000",this.eyeBallColor="#000000",this.isVcard=!1,this.gradientType="none",this.colorLight="#ffffff",this.colorDark="#000000",this.margin=50,this.text="",this.frameColor="",this.template=1,this.type="url",this.downloadFileName="Untitled 1",this.previewDivId="generated-qr-code-img",this.maskedDots=!1}isContrastLow=()=>Math.min(Math.abs(hexToHSL(customizationQr.backgroundColor)-hexToHSL(customizationQr.colorDark)),Math.abs(hexToHSL(customizationQr.backgroundColor)-hexToHSL(customizationQr.eyeFrameColor)))<40;changeQrProperty=(e,t)=>{let a;a=e?e.dataset:t;for(var[r,n]of Object.entries(a))!e||"color"!=e.type&&"color"!=e.dataset.type||(n=e.value),this[r]=n;this.generateQR()};changeQRStyle=e=>{this.dataPattern=e.dataset.qrPattern,this.eyeBallShape=e.dataset.qrEyeShape,this.eyeFrameShape=e.dataset.qrEyeFrameShape,this.generateQR()};generateQR=async()=>{isDynamicTemplate()||(isEmptyObject(qrData.data)?document.getElementById("generated-qr-code-img").innerHTML=document.getElementById("template"+qr.template).innerHTML:await new QRCodeGenerator.QRCodeBuilder({text:qrData.getData()||"default",size:1024,margin:this.margin,dotScale:1,backgroundColor:this.backgroundColor,logoBackground:this.logoBackground,frameText:this.frameText,colorDark:this.colorDark,colorLight:this.colorLight,logoImage:this.logo,dataPattern:this.dataPattern,frameStyle:this.frame,eyeBallShape:this.eyeBallShape,eyeFrameShape:this.eyeFrameShape,eyeFrameColor:this.eyeFrameColor,eyeBallColor:this.eyeBallColor,isVCard:this.isVcard,gradientType:this.gradientType,frameColor:this.frameColor,useCanvas:!0,imageServerRequestHeaders:{}}).build("png").then(e=>{this.dataUrl=e.svg}).then(()=>{this.updateQRPreview(),this.isContrastLow()?document.getElementById("contrastWarning").classList.remove("d-none"):document.getElementById("contrastWarning").classList.add("d-none")}))};selectTemplate=e=>{e=getTemplateData(e);this.changeQrProperty(null,e)};updateQRPreview=()=>{document.querySelector("#"+this.previewDivId).innerHTML=this.dataUrl};downloadQR=async()=>{var e=document.createElement("a");e.href=await svg2png(this.dataUrl),navigator.clipboard.writeText(await svg2png(this.dataUrl)),e.download=document.getElementById("fileName").value||"Untiled 1.png",e.click()}}class QrData{constructor(){this.type="url",this.data={},this.isValid=null}setData=(e,t)=>{e&&(this.type=e),t&&(this.data=t)};changeQrDataProperty=e=>{for(var[t,a]of Object.entries(e))this.data[t]=a};getData=()=>{switch(this.type){case"url":return encodeURI(this.data.url);case"contact":return"BEGIN:VCARD\nVERSION:3.0\nN:"+(this.data.lname||"")+";"+(this.data.fname||"")+";;"+(this.data.prefix||"")+"\nFN:"+(this.data.fname||"")+" "+(this.data.lname||"")+"\n"+(this.data.prefix?"PREFIX:"+this.data.prefix+"\n":"")+(this.data.title?"TITLE:"+this.data.title+"\n":"")+(this.data.org?"ORG:"+this.data.org+"\n":"")+(this.data.phone?"TEL;TYPE=other;VALUE=uri:tel:"+this.data.phone+"\n":"")+(this.data.homephone?"TEL;TYPE=mobile;VALUE=uri:tel:"+this.data.homephone+"\n":"")+(this.data.fax?"FAX:"+this.data.fax+"\n":"")+(this.data.email?"EMAIL:"+this.data.email+"\n":"")+(this.data.address?"ADR:"+this.data.address+"\n":"")+"ADR:;;"+(this.data.street||"")+";"+(this.data.city||"")+";"+(this.data.region||"")+";"+(this.data.zip||"")+"\nEND:VCARD";case"txt":return this.data.textMsg;case"sms":return encodeURI("smsto:"+this.data.phone+":")+this.data.smsMsg;case"email":return encodeURI("mailto:"+this.data.email+"?subject="+this.data.subject+"&body="+this.data.emailMsg);case"phone":return encodeURI("tel:"+this.data.phone);default:return""}};changeQrType=e=>{this.type=e.dataset.qrType}}function isDynamicTemplate(){return 1<qr.template&&qr.template<9}function addListenerToInputFields(){document.querySelectorAll(".input").forEach(t=>{let a=t.dataset.inputType;addErrorMsgDivOnInput(t);let r;t.addEventListener("keyup",function(e){clearTimeout(r);checkErrorOnInput(t)?(qrData.isValid=!0,isDynamicTemplate()||enableUtilityBtns()):(disbleUtilityBtns(),qrData.isValid=!1);e={[a]:e.target.value};qrData.changeQrDataProperty(e),addOrRemoveLoaderAnimation("generated-qr-code-img",!0),r=setTimeout(()=>{qr.generateQR(),addOrRemoveLoaderAnimation("generated-qr-code-img",!1)},500),showConvertToDynamicBanner()})})}function addOrRemoveLoaderAnimation(e,t=!1){t?document.getElementById(e).classList.add("loader"):document.getElementById(e).classList.remove("loader")}let addErrorMsgDivOnInput=e=>{var t,a=e.dataset.inputType;document.getElementById("input_helper_text_"+a)||((t=document.createElement("sub")).innerHTML="",t.className="input_helper_text",t.id="input_helper_text_"+a,e.after(t))},checkErrorOnInput=e=>{var t=e.dataset.inputType,a=document.getElementById("input_helper_text_"+t);return!(!e.value||inputTypeRegex[t]&&(""===e.value?(a.innerHTML=inputTypeRegex[t].helpertext||"",a.classList.remove("error"),e.classList.remove("error"),1):inputTypeRegex[t]&&!inputTypeRegex[t].regex.test(e.value)?(e.classList.add("error"),a.classList.add("error"),a.innerHTML=inputTypeRegex[t].errorMsg||"",1):(e.classList.remove("error"),a.classList.remove("error"),a.innerHTML=inputTypeRegex[t].helpertext||"",0)))},showCustomizeModal=()=>{document.getElementById("customizeModal").classList.add("active"),copyQrObject(customizationQr,qr),syncQRColorsOnModal()},showModal=(window.onclick=function(a){document.querySelectorAll(".modal").forEach(e=>{a.target==e&&e.classList.contains("active")&&e.classList.remove("active")}),document.querySelectorAll("[data-dismiss-target]").forEach(e=>{var t=document.getElementById(e.dataset.dismissTarget);a.target==e&&t.classList.contains("active")&&t.classList.remove("active")}),document.querySelectorAll(".dropdown_content").forEach(e=>{a.target.classList.contains("dropdown-btn")||"copy_dropdown"==a.target.id?e.classList.add("active"):(!a.target.classList.contains("dropdown_option")&&e.classList.contains("active")&&e.classList.remove("active"),a.target.dataset.convertToDynamic&&redirectToSignIn(a.target.dataset.convertToDynamic))})},e=>(document.getElementById(e).classList.add("active"),!1)),dismissModal=e=>(document.getElementById(e).classList.remove("active"),!1),discardQrCodeData=(document.querySelectorAll("[data-target-modal]").forEach(e=>{let t=e.dataset.targetModal;e.addEventListener("click",function(e){showModal(t)})}),()=>{qrData.data={},qr.generateQR(),document.getElementById("discardModal").classList.remove("active"),document.getElementById("blue_info_banner_parent_preview").classList.add("d-none"),changeActiveTab(nextActiveTab),disbleUtilityBtns()}),showDiscardModal=async()=>(document.getElementById("discardModal").classList.add("active"),!1),showDownloadModal=async()=>(document.getElementById("downloadModal").classList.add("active"),!1),changeActiveTab=(document.querySelectorAll("[data-tab-target]").forEach(e=>{e.addEventListener("click",async()=>{isEmptyObject(qrData.data)?(changeActiveTab(e),disbleUtilityBtns(),addListenerForRedirect()):(await showDiscardModal(),nextActiveTab=e)})}),(e,t)=>{removeActiveClassFromAllOptions("[data-tab-target]");var a=document.querySelector("#"+e.dataset.tabTarget),a=(document.getElementById("widget_input_tab_content").innerHTML=a.innerHTML,e.classList.add("active"),e.dataset.tabTarget.replace("tab-content-",""));qrData.setData(a,{}),qr.generateQR(),addListenerToInputFields()}),removeActiveClassFromAllOptions=e=>{document.querySelectorAll(e).forEach(e=>{e.classList.remove("active")})};function showDynamicPrompt(e){qr.template=e.dataset.templateid||1,("true"===e.dataset.isdynamic?(document.getElementsByClassName("widget_output_preview_image")[0].classList.add("disabled"),disbleUtilityBtns):(document.getElementsByClassName("widget_output_preview_image")[0].classList.remove("disabled"),qr.selectTemplate(e.dataset.templateid),qrData.isValid?enableUtilityBtns:disbleUtilityBtns))(),document.getElementById("generated-qr-code-img").innerHTML=e.innerHTML}function isEmptyObject(t){return Object.keys(t).every(function(e){return""===t[e]||null===t[e]})}document.getElementById("input_margin_slider").addEventListener("change",function(e){customizationQr.changeQrProperty(null,{margin:parseInt(e.target.value)})});let carouselScroll=(e,t)=>{let a;switch(e){case"left":a={x:-100,y:0};break;case"right":a={x:100,y:0};break;case"up":a={x:0,y:-100};break;case"down":a={x:0,y:100}}document.getElementById(t).scrollBy(a.x,a.y)};async function svg2png(e,t=1e3,a=1e3){let r=new Image;r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(e),await new Promise((e,t)=>{r.onload=e,r.onerror=t});e=document.createElement("canvas");return[e.width,e.height]=[t,a],e.getContext("2d").drawImage(r,0,0,t,a),e.toDataURL("image/png")}document.querySelectorAll("[data-selection-options]").forEach(t=>{t.addEventListener("click",function(e){removeActiveClassFromAllOptions(t.dataset.selectionOptions)})}),document.addEventListener("DOMContentLoaded",e=>{addListenerToInputFields(),setCarouselHeight()});let qr=new QRCode,qrData=new QrData,customizationQr=new QRCode;function copyQrObject(e,t){e.eyeBallShape=t.eyeBallShape,e.eyeBallColor=t.eyeBallColor,e.eyeFrameShape=t.eyeFrameShape,e.eyeFrameColor=t.eyeFrameColor,e.dataPattern=t.dataPattern,e.colorDark=t.colorDark,e.backgroundColor=t.backgroundColor,e.margin=t.margin,e.generateQR()}function setCarouselHeight(){var e=document.getElementById("generated-qr-code-img").offsetHeight;document.getElementById("templates_carousel").style.height=e-50+"px"}function showConvertToDynamicBanner(){var e=["sms","txt","contact"],t=JSON.stringify(qrData.data).length;"url"==qrData.type?30<JSON.stringify(qrData.data).length?document.getElementById("blue_info_banner_parent_url").classList.remove("d-none"):document.getElementById("blue_info_banner_parent_url").classList.add("d-none"):0<=e.indexOf(qrData.type)&&30<t||qrData.type==e[2]&&1<t?document.getElementById("blue_info_banner_parent_preview").classList.remove("d-none"):document.getElementById("blue_info_banner_parent_preview").classList.add("d-none")}function generateUrlFromCampaign(){var e=document.forms.campaign_builder_form.url,t=document.forms.campaign_builder_form.medium,a=document.forms.campaign_builder_form.source,r=document.forms.campaign_builder_form.campaign;e.value&&inputTypeRegex.url.regex.test(e.value)||(e.classList.add("error"),document.getElementById("input_helper_text_campaign_url").innerHTML="Must be a valid URL",document.getElementById("input_helper_text_campaign_url").classList.add("error")),t.value||(t.classList.add("error"),document.getElementById("input_helper_text_medium").innerHTML="This field is required",document.getElementById("input_helper_text_medium").classList.add("error")),a.value||(a.classList.add("error"),document.getElementById("input_helper_text_source").innerHTML="This field is required",document.getElementById("input_helper_text_source").classList.add("error")),inputTypeRegex.campaign_url.regex.test(e.value)&&t.value&&a.value&&((e=new URL(e.value)).searchParams.set("utm_medium",t.value),e.searchParams.set("utm_source",a.value),r.value&&e.searchParams.set("utm_campaign",r.value),document.getElementById("input_url").value=e,document.getElementById("campaignModal").classList.remove("active"),t={url:e},qrData.changeQrDataProperty(t),qr.generateQR())}function getLastParam(e,t){return e.searchParams.getAll(t).at(-1)||""}function fillCampaignBuilderFromUrl(){var e=new URL(document.getElementById("input_url").value);if(e){var t,a=getLastParam(e,"utm_source"),r=getLastParam(e,"utm_medium"),n=getLastParam(e,"utm_campaign");for(t of utmParamKeys)e.searchParams.delete(t);document.getElementById("campaignUrl").value=e.href,document.getElementById("campaignMedium").value=a,document.getElementById("campaignSource").value=r,document.getElementById("campaignCampaign").value=n}}function enableUtilityBtns(){document.getElementById("widget_output_utility_btn").classList.add("active")}function disbleUtilityBtns(){document.getElementById("widget_output_utility_btn").classList.remove("active")}function hexToHSL(e){let t=0,a=0,r=0,n=(4==e.length?(t="0x"+e[1]+e[1],a="0x"+e[2]+e[2],r="0x"+e[3]+e[3]):7==e.length&&(t="0x"+e[1]+e[2],a="0x"+e[3]+e[4],r="0x"+e[5]+e[6]),t/=255,a/=255,r/=255,Math.min(t,a,r)),o=Math.max(t,a,r),i=o-n,d=0,s;return d=0==i?0:o==t?(a-r)/i%6:o==a?(r-t)/i+2:(t-a)/i+4,(d=Math.round(60*d))<0&&(d+=360),s=(o+n)/2,(100*(0==i?0:i/(1-Math.abs(2*s-1)))).toFixed(1),+(100*s).toFixed(1)}function mapCodeContent(e){switch(e){case"url":return qrData.data.url||"";case"email":return{email:qrData.data.email||"",subject:qrData.data.subject||"",body:qrData.data.emailMsg||""};case"sms":return{number:qrData.data.phone||"",message:qrData.data.smsMsg||""};case"phone":return qrData.data.phone;case"txt":return qrData.data.textMsg;case"contact":return{prefix:qrData.data.prefix||"",name:qrData.data.lname||"",firstname:qrData.data.fname||"",organization:qrData.data.org||"",title:qrData.data.title||"",email:qrData.data.email||"",phone:qrData.data.phone||"",cell:qrData.data.homephone||"",fax:qrData.data.fax||"",street:qrData.data.street||"",postcode:qrData.data.postcode||"",city:qrData.data.city||"",region:qrData.data.region||"",country:qrData.data.country||"",url:[qrData.data.url||""]};default:return""}}function convertToDynamic(e="qr-widget"){var t=dashboardURL,a=[{title:"Untitled 1",qrcode:{content:mapCodeContent(qrData.type),type:qrData.type},codeDesignId:codeDesignIdsForDashboard[qr.template-1]},{appVersion:2,logoImageId:void 0,logoPadding:1,logoSize:1,shapePreset:"areas",size:1e3,title:"Custom",userBgColor:"#ffffff",userDotColor:"#fbc02d",userMargin:1,userPatternColor:"#80D884"},-1],a=JSON.stringify(a),t=new URL(t);return t.pathname="/mycodes/new",t.searchParams.set("sns",a),"qrType"==e&&(e=qrData.type),t.searchParams.set("signup_source",e),t.toString()}function redirectToSignIn(e){window.location.href=convertToDynamic(e)}function convertHexToSix(e){return"#"+(e=3===(e=e.replace("#","")).length?e.split("").map(function(e){return e+e}).join(""):e)}function addListenerForRedirect(){document.querySelectorAll("[data-convert-to-dynamic]").forEach(e=>{let t=e.dataset.convertToDynamic||"qr-widget";e.addEventListener("click",function(e){window.location.href=convertToDynamic(t)})})}function syncQRColorsOnModal(){document.getElementById("input_background").value=qr.backgroundColor,document.getElementById("input_squares").value=qr.eyeFrameColor,document.getElementById("input_pixels").value=qr.colorDark,document.getElementById("input-value-background").value=qr.backgroundColor,document.getElementById("input-value-squares").value=qr.eyeFrameColor,document.getElementById("input-value-pixels").value=qr.colorDark}customizationQr.previewDivId="generated-qr-code-img-customize",document.querySelectorAll("[data-input-target]").forEach(t=>{t.addEventListener("input",function(e){e=convertHexToSix(e.target.value);inputTypeRegex.color.regex.test(e)?(customizationQr.changeQrProperty(t),document.getElementById(t.dataset.inputTarget).value=e,document.getElementById("colorError").classList.add("d-none")):document.getElementById("colorError").classList.remove("d-none")})});var i,acc=document.getElementsByClassName("accordion");for(i=0;i<acc.length;i++)acc[i].addEventListener("click",function(){this.classList.toggle("active");var e=this.nextElementSibling;e.style.maxHeight?e.style.maxHeight=null:e.style.maxHeight=e.scrollHeight+"px"});function showCopyOptions(){window.innerWidth<=700&&showModal("copyModal")}let upgradeModalSignUpSource="qr-widget";function handleSignupSourceForUpgradeModal(e){console.log("called handleSignupSourceForUpgradeModal",e),upgradeModalSignUpSource=e}function upgradeModalRedirect(){window.location.href=dashboardURL+"/sign-in?from=pricing?signup_source="+upgradeModalSignUpSource}